import{_ as s,c as a,o as i,a1 as l}from"./chunks/framework.CG9TfmPt.js";const g=JSON.parse('{"title":"安全扫描工具-clamav","description":"","frontmatter":{},"headers":[],"relativePath":"DevOps/Network/安全扫描工具-clamav.md","filePath":"DevOps/Network/安全扫描工具-clamav.md"}'),n={name:"DevOps/Network/安全扫描工具-clamav.md"},p=l(`<h1 id="安全扫描工具-clamav" tabindex="-1">安全扫描工具-clamav <a class="header-anchor" href="#安全扫描工具-clamav" aria-label="Permalink to &quot;安全扫描工具-clamav&quot;">​</a></h1><h2 id="_1、官网下载" tabindex="-1">1、官网下载 <a class="header-anchor" href="#_1、官网下载" aria-label="Permalink to &quot;1、官网下载&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/src</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://www.clamav.net/downloads/production/clamav-1.3.1.linux.x86_64.rpm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rpm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ivh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --prefix=/usr/local/clamav</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav-1.3.1.linux.x86_64.rpm</span></span></code></pre></div><h2 id="_2、创建用户及用户组" tabindex="-1">2、创建用户及用户组 <a class="header-anchor" href="#_2、创建用户及用户组" aria-label="Permalink to &quot;2、创建用户及用户组&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">groupadd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav</span></span></code></pre></div><h2 id="_3、创建日志目录及病毒库目录" tabindex="-1">3、创建日志目录及病毒库目录 <a class="header-anchor" href="#_3、创建日志目录及病毒库目录" aria-label="Permalink to &quot;3、创建日志目录及病毒库目录&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/update</span></span></code></pre></div><h2 id="_4、创建日志文件" tabindex="-1">4、创建日志文件 <a class="header-anchor" href="#_4、创建日志文件" aria-label="Permalink to &quot;4、创建日志文件&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/clamd.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/freshclam.log</span></span></code></pre></div><h2 id="_5、文件目录授权" tabindex="-1">5、文件目录授权 <a class="header-anchor" href="#_5、文件目录授权" aria-label="Permalink to &quot;5、文件目录授权&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav:clamav</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/clamd.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav:clamav</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/freshclam.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav:clamav</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/update</span></span></code></pre></div><h2 id="_6、创建配置文件" tabindex="-1">6、创建配置文件 <a class="header-anchor" href="#_6、创建配置文件" aria-label="Permalink to &quot;6、创建配置文件&quot;">​</a></h2><blockquote><ul><li>clamd.conf</li></ul></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/etc/clamd.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Example  //注释掉这一行</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#添加以下内容</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LogFile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/clamd.log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PidFile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/update/clamd.pid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DatabaseDirectory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/update</span></span></code></pre></div><blockquote><ul><li>freshclam.conf</li></ul></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/etc/freshclam.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Example　　//注释掉这一行</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#添加以下内容</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DatabaseDirectory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UpdateLogFile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/freshclam.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PidFile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/update/freshclam.pid</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/etc/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/etc/</span></span></code></pre></div><h2 id="_7、配置库文件路径" tabindex="-1">7、配置库文件路径 <a class="header-anchor" href="#_7、配置库文件路径" aria-label="Permalink to &quot;7、配置库文件路径&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/ld.so.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#下面追加一行：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/lib64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ldconfig</span></span></code></pre></div><h2 id="_8、更新病毒库" tabindex="-1">8、更新病毒库 <a class="header-anchor" href="#_8、更新病毒库" aria-label="Permalink to &quot;8、更新病毒库&quot;">​</a></h2><blockquote><ul><li>方法1：在线更新病毒库</li></ul></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#增加权限，确保有权限写入更新文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav.clamav</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/freshclam</span></span></code></pre></div><blockquote><ul><li>方法2：下载病毒库文件手动上传到 /usr/local/clamav/update目录</li></ul></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http://db.cn.clamav.net/daily.cvd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http://db.cn.clamav.net/main.cvd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http://db.cn.clamav.net/safebrowsing.cvd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http://db.cn.clamav.net/bytecode.cvd</span></span></code></pre></div><h2 id="_9、运行使用" tabindex="-1">9、运行使用 <a class="header-anchor" href="#_9、运行使用" aria-label="Permalink to &quot;9、运行使用&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/bin/clamscan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/sbin/clamscan</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/clamscan</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查杀当前目录下的文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/clamscan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查杀当前目录的所有文件及目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/clamscan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查杀dir目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/clamscan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查杀目录dir下的所有文件及目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/clamscan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查杀dir目录的所有文件及目录并且打印出日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local/clamav/bin/clamscan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/clamav/logs/clamd.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 递归扫描home目录，将病毒文件删除，并且记录日志，将有问题的文件都会进行记录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clamscan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --remove</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/log/clamscan.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 扫描指定目录，然后将感染文件移动到指定目录，并记录日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clamscan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --move=/opt/infected</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/log/clamscan.log</span></span></code></pre></div>`,25),e=[p];function h(t,k,c,d,r,o){return i(),a("div",null,e)}const C=s(n,[["render",h]]);export{g as __pageData,C as default};
