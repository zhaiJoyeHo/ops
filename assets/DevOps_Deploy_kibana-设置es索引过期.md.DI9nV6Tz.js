import{_ as s,c as i,o as a,a1 as h}from"./chunks/framework.CG9TfmPt.js";const y=JSON.parse('{"title":"kibana-设置es索引过期","description":"","frontmatter":{},"headers":[],"relativePath":"DevOps/Deploy/kibana-设置es索引过期.md","filePath":"DevOps/Deploy/kibana-设置es索引过期.md"}'),t={name:"DevOps/Deploy/kibana-设置es索引过期.md"},k=h(`<h1 id="kibana-设置es索引过期" tabindex="-1">kibana-设置es索引过期 <a class="header-anchor" href="#kibana-设置es索引过期" aria-label="Permalink to &quot;kibana-设置es索引过期&quot;">​</a></h1><h2 id="一、前言" tabindex="-1">一、前言 <a class="header-anchor" href="#一、前言" aria-label="Permalink to &quot;一、前言&quot;">​</a></h2><blockquote><ul><li>EFK存放了大量日志索引，只希望保留几（15）天的日志索引，希望到期删除对应的索引。</li><li>通过给索引添加生命周期策略，不需要手动设置定时器去调用es的api去删除。</li></ul></blockquote><h2 id="二、配置" tabindex="-1">二、配置 <a class="header-anchor" href="#二、配置" aria-label="Permalink to &quot;二、配置&quot;">​</a></h2><h3 id="_1-创建索引生命周期策略" tabindex="-1">1. 创建索引生命周期策略 <a class="header-anchor" href="#_1-创建索引生命周期策略" aria-label="Permalink to &quot;1. 创建索引生命周期策略&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Lifecycle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Policies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Policy，添加策略名称</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 点击右侧的删除按钮，关闭热阶段滚动更新，才会出现Delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phase，右侧设置过期时间，快照不用，保存</span></span></code></pre></div><h3 id="_2-手动给索引设置删除策略" tabindex="-1">2. 手动给索引设置删除策略 <a class="header-anchor" href="#_2-手动给索引设置删除策略" aria-label="Permalink to &quot;2. 手动给索引设置删除策略&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 只针对具体的索引，不推荐</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Indices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 勾选列表中的索引</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Manage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lifecycle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选择目标策略后应用</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果过期时间比较短，点击索引查看状态会显示当前阶段是delete（等几分钟就会被删除），如果过期时间比较长则会出现hot阶段</span></span></code></pre></div><h3 id="_3-自动给索引设置删除策略" tabindex="-1">3. 自动给索引设置删除策略 <a class="header-anchor" href="#_3-自动给索引设置删除策略" aria-label="Permalink to &quot;3. 自动给索引设置删除策略&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实际项目中日志索引是自动生成的，通过logstash或者是fluentd插件默认情况下会有一个索引创建模版</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Templates</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 默认是没有ILM策略的，找到索引生命周期策略，点击加号选择目标索引模版后保存</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Management</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Lifecycle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Policies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> skywalking-del-policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> legacy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> templates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> legacy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> templates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (关联起来)</span></span></code></pre></div><p>​</p><p>​</p>`,12),n=[k];function l(e,p,d,F,r,g){return a(),i("div",null,n)}const o=s(t,[["render",l]]);export{y as __pageData,o as default};
